<html>
  <head>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jszip/3.1.4/jszip.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  </head>
<body>
  
<form id="data" method="post" enctype="multipart/form-data">
    <input name="excelFile" type="file" />
    <input name="apikey" type="password" />
    <button>Submit</button>
</form>
 

<script>
  $("form#data").bind('submit', function (e) {
  //$("form#data").submit(function(e) {
    e.preventDefault();
    var formData = new FormData(this);
    var apiKey = formData.get("apikey");
  //form.append("filename", "Persons.xlsx");
    
  var settings = {
    "async": true,
    "url": "http://accredservice.azurewebsites.net/accred/crunch",
    "method": "POST",
    "headers": {
      "apikey": apiKey,
      "cache-control": "no-cache"
    },
    "processData": false,
    "contentType": false,
    "mimeType": "multipart/form-data",
    "data": formData
  }

  $.ajax(settings).done(function (response) {
    JSZip.loadAsync(response).then(function (zip) {
        saveAs(zip, "pdfs.zip");
    });
  });
})
</script>
</body>
</html>
